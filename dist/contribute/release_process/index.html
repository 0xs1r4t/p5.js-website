<!DOCTYPE html><html><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=/_astro/_slug_.C79K3bky.css rel=stylesheet /></head><body><nav><ul><a href=/ >Home</a> <a href=/reference>Reference</a> <a href=/tutorials>Tutorials</a> <a href=/examples>Examples</a> <a href=/community>Community</a> <a href=/about>About</a> <a href=/contribute>Contribute</a></ul></nav><div class="flex space-x-2"><select id=locale-select><option value=/contribute//release_process/ selected=true>English</option><option value=/ar/contribute//release_process/ >العربية</option><option value=/es/contribute//release_process/ >español</option><option value=/hi/contribute//release_process/ >हिन्दी</option><option value=/ko/contribute//release_process/ >한국어</option><option value=/pt-br/contribute//release_process/ >português (Brasil)</option><option value=/sk/contribute//release_process/ >slovenčina</option><option value=/zh/contribute//release_process/ >中文</option></select><script>document.getElementById("locale-select")?.addEventListener("change",(function(){window.location.href=this.value}))</script><div><form action=/search method=GET role=search><label for=search-term>Search</label> <input aria-label="Search through site content" class="border border-black" id=search-term name=term required type=search> <button type=submit>Search</button></form></div><div>Language: en</div><div>Accessibility</div></div><h1 class="font-bold text-lg">Placeholder title</h1><span></span><main><h1 id=release-process>Release process</h1><h2 id=approach>Approach</h2><ul><li>We follow the <a href=https://semver.org/ >semver</a> versioning pattern, which means we follow this versioning pattern: <code>MAJOR:MINOR:PATCH</code>.</li></ul><h2 id=requirements>Requirements</h2><ul><li>Git, node.js and NPM installed on your system</li><li>You are able to build the library and have push access to the remote repository</li><li>Secret <code>NPM_TOKEN</code> value is set on the remote repository</li><li>Secret <code>ACCESS_TOKEN</code> value is set on the remote repository</li></ul><h2 id=security-tokens>Security tokens</h2><p>For the release steps to run fully, two <a href=https://docs.github.com/en/actions/security-guides/encrypted-secrets#creating-encrypted-secrets-for-a-repository>repository secrets</a> must be set as below.</p><ul><li><code>NPM_TOKEN</code> can be created by following the steps <a href=https://docs.npmjs.com/creating-and-viewing-access-tokens>here</a> to create a read and publish token. The user the token belongs to must have publish access to the project on NPM.</li><li><code>ACCESS_TOKEN</code> is a personal access token for a user that has access to <code>p5.js</code>, <code>p5.js-website</code>, and <code>p5.js-release</code> repositories. The token can be generated using the steps <a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token>here</a> and for scopes, choose only <code>repo</code> and <code>workflow</code>. It is recommended to use an organization specific account for this (ie. not from a personal account) and limit the account’s write access to only the required repositories.</li></ul><h2 id=usage>Usage</h2><pre class="astro-code github-dark" style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>$</span><span style=color:#9ecbff> git</span><span style=color:#9ecbff> checkout</span><span style=color:#9ecbff> main</span></span>
<span class=line><span style=color:#b392f0>$</span><span style=color:#9ecbff> npm</span><span style=color:#9ecbff> version</span><span style=color:#e1e4e8> [major</span><span style=color:#f97583>|</span><span style=color:#b392f0>minor</span><span style=color:#f97583>|</span><span style=color:#b392f0>patch]</span><span style=color:#6a737d> # Choose the appropriate version tag</span></span>
<span class=line><span style=color:#b392f0>$</span><span style=color:#9ecbff> git</span><span style=color:#9ecbff> push</span><span style=color:#9ecbff> origin</span><span style=color:#9ecbff> main</span></span>
<span class=line><span style=color:#b392f0>$</span><span style=color:#9ecbff> git</span><span style=color:#9ecbff> push</span><span style=color:#9ecbff> origin</span><span style=color:#9ecbff> v1.4.2</span><span style=color:#6a737d> # Replace the version number with the one just created above</span></span></code></pre><p>The actual release steps are all run on GitHub Actions CI.</p><h2 id=monitor-and-check-results>Monitor and check results</h2><p>Once the above commands have been executed, the build and release action can be monitored from the <a href=https://github.com/processing/p5.js/actions>“Actions” tab</a> on the p5.js GitHub repo page (look for a job that says “New p5.js release”), clicking into the job can give a more detailed job log of what’s running.</p><p><img alt="Screenshot of GitHub action running the &#34;New p5.js release&#34; job" src=/images/contributor-docs/release-action.png /></p><p>Once the job has completed, the library will have been released on GitHub and NPM. Check the <a href=https://github.com/processing/p5.js/releases>release</a> and <a href=https://www.npmjs.com/package/p5>NPM</a> pages to see that the latest version is released. You should view the draft release on GitHub, make changes to changelog if necessary, then publish the release.</p><p>The website will be updated as soon as its own build and deploy job is completed, this can also be monitored in the relevant <a href=https://github.com/processing/p5.js-website/actions>“Actions” page</a> if desired, and after that check the <a href=https://p5js.org/download/ >“Downloads” page</a> on the website for the latest version number.</p><p>CDNs will take a bit more time (a day or two) to update but they will automatically pull from NPM upon release so no specific action is required.</p><hr/><h2 id=whats-actually-happening>What’s actually happening</h2><p>The GitHub Action <a href=../.github/workflows/release.yml>“New p5.js release”</a> is triggered on a tag that matches the pattern <code>v*.*.*</code> which is created by the <code>npm version ___</code> command.</p><p>Once triggered, it will run the following steps:</p><ol><li>Clone the repository, setup node.js, extract version number, install dependencies with <code>npm</code>, and run test with <code>npm test</code>.</li><li>Create the release files that will be uploaded to GitHub releases.</li><li>Create a release on GitHub and publish latest version on NPM.</li><li>Update website files<ol><li>Clone the website repository</li><li>Copy <code>data.json</code> and <code>data.min.json</code> to the right location</li><li>Copy <code>p5.min.js</code> and <code>p5.sound.min.js</code> to the right location</li><li>Update <code>data.yml</code> file with latest version number</li><li>Update <code>en.json</code> file based on <code>data.min.json</code></li><li>Commit and push the changes back to the website repository</li></ol></li><li>Update Bower files<ol><li>Clone the Bower release repository</li><li>Copy all libraries files to the right location</li><li>Commit and push the changes back to the website repository</li></ol></li></ol><p>In principle, we try to concentrate as many steps as possible to be run in one place, ie. in the CI environment. If a new step that is only run on release is required, it should probably be defined in the CI workflow and not as part of the build configuration.</p><h2 id=testing>Testing</h2><p>As the release steps are run in CI, testing them can be difficult. Using <a href=https://github.com/nektos/act>act</a> to test running of the steps locally is possible (and was how they were tested while being developed) but require some temporary modifications to the workflow definition, we’ll roughly document here as the precise steps will likely change over time.</p><p>The test steps will not run because not all system requirements are present to run the mocha Chrome tests. Some system dependencies will likely be needed to be installed with <code>apt</code> before setting up the rest of the environment. Keep an eye on the error messages which should give some information on what packages are missing.</p><p>The steps concerning pushing changes to remote repositories should be commented out to avoid accidentally pushing unintended changes.</p></main><div>p5.js site footer goes here</div></body></html>