<!DOCTYPE html><html><head><meta charset=utf-8><meta content="width=device-width,initial-scale=1" name=viewport><link href=/_astro/_slug_.C79K3bky.css rel=stylesheet /></head><body><nav><ul><a href=/ >Home</a> <a href=/reference>Reference</a> <a href=/tutorials>Tutorials</a> <a href=/examples>Examples</a> <a href=/community>Community</a> <a href=/about>About</a> <a href=/contribute>Contribute</a></ul></nav><div class="flex space-x-2"><select id=locale-select><option value=/contribute//project_wrapups/aryan_koundal_gsoc_2023/ selected=true>English</option><option value=/ar/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >العربية</option><option value=/es/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >español</option><option value=/hi/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >हिन्दी</option><option value=/ko/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >한국어</option><option value=/pt-br/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >português (Brasil)</option><option value=/sk/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >slovenčina</option><option value=/zh/contribute//project_wrapups/aryan_koundal_gsoc_2023/ >中文</option></select><script>document.getElementById("locale-select")?.addEventListener("change",(function(){window.location.href=this.value}))</script><div><form action=/search method=GET role=search><label for=search-term>Search</label> <input aria-label="Search through site content" class="border border-black" id=search-term name=term required type=search> <button type=submit>Search</button></form></div><div>Language: en</div><div>Accessibility</div></div><h1 class="font-bold text-lg">Placeholder title</h1><span></span><main><h1 id=improving-p5js-webgl3d-functionality>Improving p5.js WebGL/3d functionality</h1><h4 id=by-aryan-koundalaryankoundal>By Aryan Koundal(@AryanKoundal)</h4><h4 id=mentored-by--dave-pagurekdavepagurek--tanvi-kumartanvikumar>Mentored by : Dave Pagurek(@davepagurek ), Tanvi Kumar(@TanviKumar )</h4><h2 id=overview>Overview</h2><p>In p5.js, there are two render modes: P2D (default renderer) and WebGL. WEBGL enables the user to draw in 3D. There are many ways to implement lighting. Currently, p5js has implemented 8. To add lighting to a 3D object, one can use these functionalities. But there is another technique to light objects, not by direct light, but using the surrounding environment as a single light source, which we call Image-Based lighting. This project aims to add lighting to a 3D object, using the surrounding environment as a single light source, which is generally called Image-Based lighting. In simple words, one can very quickly drop in an image from real life to use as surrounding lights, rather than continuously tweaking the colors and positions of ambient, point, etc lights.</p><ol><li>Diffused IBL<ol><li>Create scene’s irradiance.</li><li>Calculation of Scene’s irradiance for any direction.<ol><li>Sample the scene’s radiance from all possible directions, within the hemisphere, for each fragment.</li><li>Take a finite number of samples of the scene’s irradiance and pre-compute them.</li><li>Create a pre-computed irradiance map.</li></ol></li><li>Sample the pre-computed irradiance map to retrieve diffuse irradiance.</li></ol></li><li>Specular IBL<ol><li>We need to preconvolute it.</li><li>Use split sum approximation to divide the specular part into 2 further parts<ol><li>First one is a prefiltered environment map.<ol><li>Finalize Pre filter convolution using low discrepancy hammersley sequence and sample generation defined.</li><li>Capturing prefilter mipmap levels, storing the results in prefiltered environment cubemap</li></ol></li><li>Second one is BDRF<ol><li>pre -calculate the BRDF’s response given input as roughness and angle between n and wi. Precalculations done using BRDF’S geometry function and Fresnel-Schlicks approximation.</li><li>Stored in 2D lookup texture known as BRDF integration map.</li></ol></li></ol></li><li>Combine the prefiltered environment map and BRDF integration map</li></ol></li><li>Combine the diffused and specular parts</li></ol><h2 id=current-state-of-the-project>Current State of The Project</h2><p>The project is completed and here are some screenshots and videos demonstrating the work.</p><h4 id=image-of-example-1>Image of Example 1</h4><p><img alt="example 1" src=https://github.com/processing/p5.js/assets/77334487/8d818df0-17a8-4332-b369-bcb79a5afc67 /></p><h4 id=video-of-example-1>Video of Example 1</h4><p><a href=https://github.com/processing/p5.js/assets/77334487/44b30c77-33c1-41d0-ada5-282424978832>https://github.com/processing/p5.js/assets/77334487/44b30c77-33c1-41d0-ada5-282424978832</a></p><h4 id=image-of-example-2>Image oF Example 2</h4><p><img alt="example 2" src=https://github.com/processing/p5.js/assets/77334487/e46f24b8-2713-4d2b-8392-744585da6a5b /></p><h4 id=video-of-example-2>Video of Example 2</h4><p><a href=https://github.com/processing/p5.js/assets/77334487/a0a6b3f9-b25b-451f-961e-b2970cb9e907>https://github.com/processing/p5.js/assets/77334487/a0a6b3f9-b25b-451f-961e-b2970cb9e907</a></p><h2 id=pull-request>Pull Request</h2><ul><li>Pull Request: <a href=https://github.com/processing/p5.js/pull/6255>https://github.com/processing/p5.js/pull/6255</a></li><li>Work Reports:<ul><li><a href=https://aryankoundal.medium.com/p5js-week-1-report-gsoc23-processing-foundation-9910934112e5>p5js Week 1 Report | GSoC’23 Processing Foundation</a></li><li><a href=https://aryankoundal.medium.com/p5js-week-2-report-gsoc23-processing-foundation-c8a36f5cf34>p5js Week 2 Report | GSoC’23 Processing Foundation</a></li><li><a href=https://aryankoundal.medium.com/p5js-week-3-report-gsoc23-processing-foundation-39043d0363e2>p5js Week 3 Report | GSoC’23 Processing Foundation</a></li><li>and more…</li></ul></li></ul><h2 id=work-done>Work Done</h2><h3 id=srcwebgllightjs>src/webgl/light.js</h3><ol><li>This includes the function <code>imageLight()</code> which provides the whole functionality.</li><li>2 Examples for the <code>imageLight()</code> are also included in this files.</li></ol><h3 id=srcwebglp5renderergljs>src/webgl/p5.RendererGL.js</h3><ol><li>This includes 2 new maps, which are diffusedTextures and specularTextures for storing the p5 graphics.</li><li>Then the function <code>getDiffusedTexture()</code> which gets called from _setImageLightUniforms. It’s function is to create a blurry image from the input non blurry img, if it doesn’t already exist.</li><li>Also the function <code>getSpecularTexture()</code> which also gets called from _setImageLightUniforms. It’s function is too create a texture from the input non blurry image, if it doesn’t already exist</li><li>Then the function <code>_setImageLightUniforms()</code>. It creates the textures and sets those textures in the shader being processed.</li></ol><h3 id=srcwebglp5texturejs>src/webgl/p5.Texture.js</h3><ol><li>This includes the <code>MipmapTexture</code> class.</li></ol><h3 id=srcwebglshadersimagelightvert>src/webgl/shaders/imageLight.vert</h3><ol><li>It is a vertex shader only for the image Light feature.</li></ol><h3 id=srcwebglshadersimagelightdiffusedfrag>src/webgl/shaders/imageLightDiffused.frag</h3><ol><li>It is the Fragment shader for the calculations of the Diffused Part of Image Light.</li></ol><h3 id=srcwebglshadersimagelightspecularfrag>src/webgl/shaders/imageLightSpecular.frag</h3><ol><li>It is the Fragment shader for the calculations of the Specular Part of Image Light.</li><li>It has the functions <code>HammersleyNoBitOps()</code> , <code>VanDerCorput()</code>and <code>ImportanceSampleGGX()</code> which are referenced from “<a href=https://learnopengl.com/PBR/IBL/Specular-IBL>https://learnopengl.com/PBR/IBL/Specular-IBL</a>”</li></ol><h3 id=srcwebglshaderslightingglsl>src/webgl/shaders/lighting.glsl</h3><ol><li>This includes <code>calculateImageDiffuse()</code> and <code>calculateImageSpecular()</code> which actually calculates the output textures. These are calculated only when <code>imageLight()</code> is called.</li></ol><h3 id=list-of-all-shaders-modified-to-improve-webgl-compatibility-to-newer-versions>List of All shaders modified to improve webGL compatibility to newer versions</h3><ol><li>src/webgl/shaders/basic.frag</li><li>src/webgl/shaders/immediate.vert</li><li>src/webgl/shaders/light.vert</li><li>src/webgl/shaders/light_texture.frag</li><li>src/webgl/shaders/line.frag</li><li>src/webgl/shaders/line.vert</li><li>src/webgl/shaders/normal.frag</li><li>src/webgl/shaders/normal.vert</li><li>src/webgl/shaders/phong.frag</li><li>src/webgl/shaders/phong.vert</li><li>src/webgl/shaders/point.frag</li><li>src/webgl/shaders/point.vert</li><li>src/webgl/shaders/vertexColor.frag</li><li>src/webgl/shaders/vertexColor.vert</li></ol><h3 id=sketches-i-made-which-might-be-useful>Sketches I made, which might be useful</h3><ol><li>Example 1 in imagelight <a href=https://editor.p5js.org/aryan_koundal/sketches/OEsyk6uZI>https://editor.p5js.org/aryan_koundal/sketches/OEsyk6uZI</a></li><li>Example 2 in imagelight <a href=https://editor.p5js.org/aryan_koundal/sketches/XjalPP7s4>https://editor.p5js.org/aryan_koundal/sketches/XjalPP7s4</a></li><li>Final Prototype Diffused + Roughness (Variable Roughness) <a href=https://editor.p5js.org/aryan_koundal/sketches/4V790dB9Z>https://editor.p5js.org/aryan_koundal/sketches/4V790dB9Z</a></li><li>Diffuse light final prototype <a href=https://editor.p5js.org/aryan_koundal/sketches/q_Zg37OB2>https://editor.p5js.org/aryan_koundal/sketches/q_Zg37OB2</a></li><li>Mipmap Specular roughness Prototype (visible variation) <a href=https://editor.p5js.org/aryan_koundal/sketches/Bi2BN7zjK>https://editor.p5js.org/aryan_koundal/sketches/Bi2BN7zjK</a></li><li>Specular prefilterconvolution with chessboard <a href=https://editor.p5js.org/aryan_koundal/sketches/qaIhxRZHI>https://editor.p5js.org/aryan_koundal/sketches/qaIhxRZHI</a></li><li>Prefilterconvolution cubemaps prototypes 8 levels <a href=https://editor.p5js.org/aryan_koundal/sketches/YJTSFKhqt>https://editor.p5js.org/aryan_koundal/sketches/YJTSFKhqt</a></li><li>Specular prefilterconvolution with image <a href=https://editor.p5js.org/aryan_koundal/sketches/8divJgdQxO>https://editor.p5js.org/aryan_koundal/sketches/8divJgdQxO</a></li><li>Specular mipmaps prototype with colors <a href=https://editor.p5js.org/aryan_koundal/sketches/3V9iDH8ax>https://editor.p5js.org/aryan_koundal/sketches/3V9iDH8ax</a></li><li>Sphere with point Lights <a href=https://editor.p5js.org/aryan_koundal/sketches/9NdeCtfdW>https://editor.p5js.org/aryan_koundal/sketches/9NdeCtfdW</a></li><li>Diffused texture Shader Prototype <a href=https://editor.p5js.org/aryan_koundal/sketches/DcFDcOFUn>https://editor.p5js.org/aryan_koundal/sketches/DcFDcOFUn</a></li><li>Resolution Pixelwise <a href=https://editor.p5js.org/aryan_koundal/sketches/5RfDIy2I9>https://editor.p5js.org/aryan_koundal/sketches/5RfDIy2I9</a></li><li>Cube reflecting mountain spheremap <a href=https://editor.p5js.org/aryan_koundal/sketches/2QS5-Fy0V>https://editor.p5js.org/aryan_koundal/sketches/2QS5-Fy0V</a></li><li>Cube reflecting sky spheremap <a href=https://editor.p5js.org/aryan_koundal/sketches/O1NwI4ufp>https://editor.p5js.org/aryan_koundal/sketches/O1NwI4ufp</a></li></ol><h2 id=further-improvement>Further Improvement</h2><p>While working on this project, I realised that there is scope for improvement. Like increasing efficiency by using cubemaps instead of environment maps for Diffused Lighting. Also using framebuffers would improve the efficiency and reduce the time taken to render the lights.</p><h2 id=conclusion>Conclusion</h2><p>My GSoC experience was genuinely transformative, leading to significant personal and professional development within the open-source domain. I successfully overcame initial obstacles related to setting up the project and navigating the codebase, steadily advancing through my contributions. Throughout this summer, I actively participated in the p5.js open-source community, surpassing my initial expectations for my first major open-source venture and further igniting my enthusiasm. I want to express my heartfelt appreciation to my mentors, Dave Pagurek(@davepagurek ), and Tanvi Kumar(@TanviKumar ), for their invaluable guidance in navigating coding challenges. Effective teamwork, collaboration, and communication proved essential in this open-source journey. I eagerly anticipate expanding my contributions and honing my skills. This summer has instilled a sense of purpose in me, and I’m profoundly grateful for the mentorship and knowledge gained.</p></main><div>p5.js site footer goes here</div></body></html>